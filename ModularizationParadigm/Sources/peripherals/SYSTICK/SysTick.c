#include "SYSTICK/systick.h"

extern uint32_t ticks_counter;

void SysTick_Init(void)
{
	/* SYST_CSR: ??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,COUNTFLAG=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,CLKSOURCE=0,TICKINT=0,ENABLE=0 */
	SYST_CSR = 0x00U;

	/* SYST_RVR: ??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,RELOAD=0 */
	SYST_RVR = SysTick_RVR_RELOAD( 0x00 );

	/* SYST_CVR: ??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,CURRENT=0 */
	SYST_CVR = SysTick_CVR_CURRENT( 0x00 );

	/* SYST_CSR: ??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,COUNTFLAG=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,??=0,CLKSOURCE=1,TICKINT=1,ENABLE=1 */
	SYST_CSR = SysTick_CSR_CLKSOURCE_MASK | SysTick_CSR_TICKINT_MASK | SysTick_CSR_ENABLE_MASK;

	/* Also enable interrupts */
	NVIC_EnableIRQ(SysTick_IRQn);

	/* Interrupt priority - 0 is the highest*/
	NVIC_SetPriority(SysTick_IRQn, 0);
}

void SysTick_Handler(void)
{
	ticks_counter++;
}
